{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@flarum/messages/webpack/bootstrap","webpack://@flarum/messages/webpack/runtime/compat get default export","webpack://@flarum/messages/webpack/runtime/define property getters","webpack://@flarum/messages/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/messages/webpack/runtime/make namespace object","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'admin/app')\"","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'common/extenders')\"","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'common/Model')\"","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'common/utils/computed')\"","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'common/utils/string')\"","webpack://@flarum/messages/./src/common/models/DialogMessage.ts","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@flarum/messages/./src/common/models/Dialog.ts","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'common/models/User')\"","webpack://@flarum/messages/./src/common/extend.ts","webpack://@flarum/messages/external root \"flarum.reg.get('core', 'admin/components/SettingDropdown')\"","webpack://@flarum/messages/./src/admin/extend.tsx","webpack://@flarum/messages/./src/admin/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extenders');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Model');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/computed');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/string');","import Model from 'flarum/common/Model';\nimport computed from 'flarum/common/utils/computed';\nimport { getPlainContent } from 'flarum/common/utils/string';\nexport default class DialogMessage extends Model {\n  number() {\n    return Model.attribute('number').call(this);\n  }\n  content() {\n    return Model.attribute('content').call(this);\n  }\n  contentHtml() {\n    return Model.attribute('contentHtml').call(this);\n  }\n  renderFailed() {\n    return Model.attribute('renderFailed').call(this);\n  }\n  contentPlain() {\n    return computed('contentHtml', content => {\n      if (typeof content === 'string') {\n        return getPlainContent(content);\n      }\n      return content;\n    }).call(this);\n  }\n  createdAt() {\n    return Model.attribute('createdAt', Model.transformDate).call(this);\n  }\n  dialog() {\n    return Model.hasOne('dialog').call(this);\n  }\n  user() {\n    return Model.hasOne('user').call(this);\n  }\n  canDelete() {\n    return Model.attribute('canDelete').call(this);\n  }\n}\nflarum.reg.add('flarum-messages', 'common/models/DialogMessage', DialogMessage);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","import Model from 'flarum/common/Model';\nimport app from 'flarum/common/app';\nexport default class Dialog extends Model {\n  title() {\n    return Model.attribute('title').call(this);\n  }\n  type() {\n    return Model.attribute('type').call(this);\n  }\n  lastMessageAt() {\n    return Model.attribute('lastMessageAt', Model.transformDate).call(this);\n  }\n  createdAt() {\n    return Model.attribute('createdAt', Model.transformDate).call(this);\n  }\n  users() {\n    return Model.hasMany('users').call(this);\n  }\n  firstMessage() {\n    return Model.hasOne('firstMessage').call(this);\n  }\n  lastMessage() {\n    return Model.hasOne('lastMessage').call(this);\n  }\n  unreadCount() {\n    return Model.attribute('unreadCount').call(this);\n  }\n  lastReadMessageId() {\n    return Model.attribute('lastReadMessageId').call(this);\n  }\n  lastReadAt() {\n    return Model.attribute('lastReadAt', Model.transformDate).call(this);\n  }\n  recipient() {\n    let users = this.users();\n    return !users ? null : users.find(user => user && user.id() !== app.session.user.id());\n  }\n}\nflarum.reg.add('flarum-messages', 'common/models/Dialog', Dialog);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/User');","import DialogMessage from './models/DialogMessage';\nimport Dialog from './models/Dialog';\nimport Extend from 'flarum/common/extenders';\nimport User from 'flarum/common/models/User';\nexport default [new Extend.Store().add('dialogs', Dialog) //\n.add('dialog-messages', DialogMessage),\n//\n\nnew Extend.Model(User) //\n.attribute('canSendAnyMessage').attribute('canDeleteOwnMessage')];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/components/SettingDropdown');","import Extend from 'flarum/common/extenders';\nimport commonExtend from '../common/extend';\nimport app from 'flarum/admin/app';\nimport SettingDropdown from 'flarum/admin/components/SettingDropdown';\nexport default [...commonExtend, new Extend.Admin().permission(() => ({\n  icon: 'fas fa-envelope-open-text',\n  label: app.translator.trans('flarum-messages.admin.permissions.send_messages_label'),\n  permission: 'dialog.sendMessage',\n  allowGuest: false\n}), 'start', 95).permission(() => ({\n  icon: 'far fa-trash-alt',\n  label: app.translator.trans('flarum-messages.admin.permissions.delete_own_messages_label'),\n  id: 'flarum-messages.allow_delete_own_messages',\n  setting: () => {\n    const minutes = parseInt(app.data.settings['flarum-messages.allow_delete_own_messages'], 10);\n    return m(SettingDropdown, {\n      default: '0',\n      key: \"flarum-messages.allow_delete_own_messages\",\n      options: [{\n        value: '-1',\n        label: app.translator.trans('core.admin.permissions_controls.allow_indefinitely_button')\n      }, {\n        value: '10',\n        label: app.translator.trans('core.admin.permissions_controls.allow_ten_minutes_button')\n      }, {\n        value: 'reply',\n        label: app.translator.trans('core.admin.permissions_controls.allow_until_reply_button')\n      }, {\n        value: '0',\n        label: app.translator.trans('core.admin.permissions_controls.allow_never_button')\n      }]\n    });\n  }\n}), 'reply', 80)];","import app from 'flarum/admin/app';\nexport { default as extend } from './extend';\napp.initializers.add('flarum-messages', () => {\n  //\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","reg","DialogMessage","number","this","content","contentHtml","renderFailed","contentPlain","getPlainContent","createdAt","dialog","user","canDelete","add","Dialog","title","type","lastMessageAt","users","firstMessage","lastMessage","unreadCount","lastReadMessageId","lastReadAt","recipient","find","id","attribute","permission","icon","label","trans","allowGuest","setting","parseInt","settings","m","default","options"],"sourceRoot":""}